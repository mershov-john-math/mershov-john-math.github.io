name: Generate index.html

on:
  push:
    branches: [ "main" ]
  workflow_dispatch:

jobs:
  build-index:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v4

    - name: Generate index.html
      run: |
        echo "<!DOCTYPE html>" > index.html
        echo "<html><head><meta charset='UTF-8'><title>Index</title></head><body>" >> index.html
        echo "<h1>Available Pages</h1><ul>" >> index.html

        # Loop through HTML files in repo root
        for file in *.html; do
          if [ "$file" != "index.html" ]; then
            echo "<li><a href='./$file'>$file</a></li>" >> index.html
          fi
        done

        echo "</ul></body></html>" >> index.html

    - name: Commit index.html
      run: |
        git config user.name "GitHub Actions"
        git config user.email "actions@github.com"
        git add index.html
        git commit -m "Auto-generate index.html" --allow-empty
        git push origin main
